<!DOCTYPE html>
<html lang="en">
<script src="http://ajax.googleapis.com/ajax/libs/angularjs/1.4.8/angular.min.js"></script>
<script src="http://code.jquery.com/jquery-1.9.1.js" type="text/javascript"></script>
<script src="https://code.highcharts.com/stock/highstock.js"></script>


<body>

<div ng-app="myApp" ng-controller="formCtrl">
  <form novalidate>
    Stock: (Only possibility is aapl)<br>
    <input type="text" ng-model="stock"><br>
    <br><br>
    <button ng-click="save()">DRAW</button>
  </form>
  <p>form = {{stock }}</p>
  <p>{{errormsg }}</p>
  <p>Stock Chart for = {{master}}</p>
            <div id="containerjson" style="height: 400px; min-width: 1000px"></div>
</div>

<script>
var app = angular.module('myApp', []);
app.controller('formCtrl', function($scope) {
    $scope.save = function() {
        $scope.master = $scope.stock;
	$.getJSON('http://www.highcharts.com/samples/data/jsonp.php?filename='+$scope.stock+'-c.json&callback=?', function(data) {
		// Create the chart
        if (!data)
            {
        $scope.errormsg = $scope.stock + " DOES NOT EXIST IN MY DATABASE"
        console.log("catching");        
        console.log($scope.errormsg );  
        $scope.$apply();
            }
        else
        {
        $scope.errormsg = ""
        $scope.$apply();
		window.chart = new Highcharts.StockChart({
			chart : {
				renderTo : 'containerjson'
			},

			rangeSelector : {
				selected : 1
			},

			title : {
				text : ($scope.master).toUpperCase()+' Stock Price'
			},
			
			series : [{
				name : $scope.master,
				data : data,
				tooltip: {
					valueDecimals: 2
				}
			}]
		});
    }
	});
        
    };
});
</script>

</body>
</html>
